{% macro button(label, variant='primary', href=None, id=None, icon=None) %}
  {% set classes = 'btn btn--' + variant %}
  {% if href %}
    <a class="{{ classes }}" href="{{ href }}" {% if id %}id="{{ id }}"{% endif %}>
      {% if icon %}<span class="btn__icon" aria-hidden="true">{{ icon }}</span>{% endif %}
      <span>{{ label }}</span>
    </a>
  {% else %}
    <button class="{{ classes }}" type="button" {% if id %}id="{{ id }}"{% endif %}>
      {% if icon %}<span class="btn__icon" aria-hidden="true">{{ icon }}</span>{% endif %}
      <span>{{ label }}</span>
    </button>
  {% endif %}
{% endmacro %}

{% macro nav(active_page='home') %}
<nav class="nav" aria-label="Primary">
  <div class="container nav__inner">
    <a class="nav__brand" href="/" aria-label="AquaPump home">
      <span class="brand__mark" aria-hidden="true"></span>
      <span class="nav__brand-label" id="brand">AquaPump</span>
    </a>
    <button class="nav__toggle" id="navToggle" aria-expanded="false" aria-controls="navMenu">
      <span class="visually-hidden">Toggle navigation</span>
      <span class="nav__toggle-bar"></span>
      <span class="nav__toggle-bar"></span>
      <span class="nav__toggle-bar"></span>
    </button>
    <div class="nav__menu" id="navMenu">
      <ul class="nav__links" role="list">
        <li><a href="/products" id="navProducts" class="nav__link {% if active_page == 'products' %}is-active{% endif %}">Products</a></li>
        <li><a href="/#technology" id="navTechnology" class="nav__link nav__link--anchor">Technology</a></li>
        <li><a href="/#sustainability" id="navSustainability" class="nav__link nav__link--anchor">Sustainability</a></li>
        <li><a href="/contact" id="navContact" class="nav__link {% if active_page == 'contact' %}is-active{% endif %}">Contact</a></li>
      </ul>
      <div class="nav__controls">
        <div class="nav__toggles" role="group" aria-label="Preferences">
          <button class="nav__chip" id="themeToggle" type="button" aria-label="Toggle theme">
            <span aria-hidden="true" data-theme-icon>‚òÄÔ∏è</span>
          </button>
          <button class="nav__chip nav__chip--lang" id="langToggle" type="button" aria-label="Toggle language">EN</button>
        </div>
        <a class="btn btn--primary btn--xl" id="ctaQuote" href="/contact">Get Quote</a>
      </div>
    </div>
  </div>
</nav>
{% endmacro %}

{% macro footer() %}
<footer class="footer">
  <div class="container footer__inner">
    <div class="footer__brand">
      <span class="brand__mark" aria-hidden="true"></span>
      <span>AquaPump</span>
    </div>
    <div class="footer__meta">¬© AquaPump. All rights reserved.</div>
  </div>
</footer>
{% endmacro %}

{% macro feature_card(idx, title, body) %}
<article class="feature" id="card{{ idx }}">
  <div class="feature__header">
    <span class="feature__index">0{{ idx }}</span>
    <h3>{{ title }}</h3>
  </div>
  <p>{{ body }}</p>
  <span class="feature__cta" aria-hidden="true">Explore ‚Üí</span>
</article>
{% endmacro %}

{% macro stat_block(idx, value, label) %}
<div class="stat" id="stat{{ idx }}">
  <div class="stat__value">{{ value }}</div>
  <div class="stat__label">{{ label }}</div>
</div>
{% endmacro %}

{% macro chatbot() %}
<div class="chatbot" data-state="closed">
  <button class="chatbot__toggle" id="chatToggle" type="button" aria-expanded="false" aria-controls="chatWindow">
    <span class="chatbot__toggle-icon" aria-hidden="true">üí¨</span>
    <span class="visually-hidden">Chat with us</span>
  </button>
  <section class="chatbot__window" id="chatWindow" aria-live="polite" aria-hidden="true">
    <header class="chatbot__header">
      <div>
        <p class="chatbot__title">AquaBot</p>
        <p class="chatbot__subtitle">How can we help?</p>
      </div>
      <button class="chatbot__close" id="chatClose" type="button" aria-label="Close chat">√ó</button>
    </header>
    <div class="chatbot__messages" id="chatMessages">
      <div class="message message--bot">
        <p>Hi! I‚Äôm AquaBot. Ask me about products, quotes, or support.</p>
        <span class="message__time">Online now</span>
      </div>
    </div>
    <form class="chatbot__form" id="chatForm">
      <label class="visually-hidden" for="chatInput">Type your message</label>
      <input class="chatbot__input" id="chatInput" name="chat" placeholder="Type a message‚Ä¶" autocomplete="off" />
      <button class="chatbot__send" type="submit">Send</button>
    </form>
  </section>
</div>
{% endmacro %}
